{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/SpPropertyBag.ts","SpPropertyBag.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","SpPropertyBag","this","divContainerId","divBlockContainerId","reloadRequired","refreshTableRequired","ctx","SP","ClientContext","get_current","web","get_web","allProperties","get_allProperties","load","onSuccess","Function","createDelegate","sender","err","showPropertiesDialog","get_fieldValues","onError","UI","Notify","addNotification","get_message","executeQueryAsync","prototype","toggleBlockModal","blockModal","html","document","getElementById","style","display","refreshAllPropertiesTable","props","items","getItemArray","innerHTML","buildTable","h","itemsCount","prop","value","executeChanges","update","console","log","window","location","reload","setProperty","key","inputId","set_item","deleteProperty","confirm","table","parentNode","removeChild","addProperty","p","type","hasOwnProperty","push","replace","sort","b","localeCompare","createElement","id","ModalDialog","showModalDialog","title","showClose","autoSize","dialogReturnValueCallback","dialogResult","SOD","executeFunc","SpPropAdmin"],"mappings":"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","file":"SpPropertyBag.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\r\n * SpPropertyBag.js\r\n * by rlv-dan (https://github.com/rlv-dan)\r\n * License: GPL3\r\n*/\r\n/// <reference path=\"../typings/sharepoint/SharePoint.d.ts\" />\r\n/// <reference path=\"../typings/microsoft-ajax/microsoft.ajax.d.ts\" />\r\n\r\ninterface window {\r\n    SpPropAdmin: any;\r\n}\r\n\r\n\r\nclass SpPropertyBag{\r\n    ctx: SP.ClientContext;\r\n    web:any;\r\n    allProperties:any;\r\n    reloadRequired:boolean;\r\n\trefreshTableRequired:boolean;\r\n\tdivContainerId:string = \"divSpPropertyBag\";\r\n\tdivBlockContainerId:string = \"divBlockSpPropertyBag\";\r\n    constructor(){\r\n        this.reloadRequired = false;\r\n\t\tthis.refreshTableRequired = false;\r\n        \r\n        this.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        \r\n        \r\n        let onSuccess:Function = Function.createDelegate(this,function(sender:any, err:any){this.showPropertiesDialog(this.allProperties.get_fieldValues());});\r\n        let onError:Function = Function.createDelegate(this,function(sender:any, err:any){SP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message(), false);});\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    };\r\n\tprivate toggleBlockModal(blockModal:Boolean){\r\n\t\tlet html:HTMLElement = document.getElementById(this.divBlockContainerId);\r\n\t\thtml.style.display = blockModal ? 'block' : 'none';\r\n\t};\r\n\tprivate refreshAllPropertiesTable(){\r\n\t\tthis.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        \r\n        \r\n        let onSuccess:Function = Function.createDelegate(this,function(sender:any, err:any){\r\n\t\t\tthis.refreshTableRequired = false;\r\n\t\t\tlet props = this.allProperties.get_fieldValues();\r\n\t\t\tlet items:Array<any> = this.getItemArray(props);\r\n\t\t\tlet html:HTMLElement = document.getElementById(this.divContainerId);\r\n\r\n\t\t\thtml.innerHTML = this.buildTable(items);\r\n\t\t\tthis.toggleBlockModal(false);\r\n\t\t});\r\n        let onError:Function = Function.createDelegate(this,function(sender:any, err:any){SP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message(), false);});\r\n\t\tthis.ctx.executeQueryAsync(onSuccess, onError);\r\n\t};\r\n\tprivate buildTable(items: Array<any>){\r\n\t\tlet h:string = '<hr><table style=\"margin: 1em;\">';\r\n\r\n\t\tfor(let i:number=0, itemsCount:number = items.length; i<itemsCount; i++) {\r\n\t\t\th += '<tr>';\r\n\t\t\th += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><button onclick=\"SpPropAdmin.setProperty(\\'' + items[i].prop + '\\',\\'prop' + i +'\\'); return false;\">Update</button></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"SpPropAdmin.deleteProperty(\\'' + items[i].prop + '\\',\\'prop' + i +'\\'); return false;\">X</button></td>';\r\n\t\t\th += '</tr>';\r\n\t\t}\r\n\t\th += '</table>';\r\n\r\n\t\th += '<hr><h3>Add a new property:</h3>';\r\n\t\th += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>';\r\n\t\th += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>';\r\n\t\th += '&nbsp;<button onclick=\"SpPropAdmin.addProperty(); return false;\">Add</button></div>';\r\n\t\th += '<div></div>';\r\n\t\th += '<div id=\"' + this.divBlockContainerId + '\" style=\"display:none; position: absolute; width: 100%; height: 100%; background-color: gray; top: 0; left: 0;opacity: .8;\"></div>';\r\n\t\treturn h;\r\n\t};\r\n    private executeChanges() {\r\n\t\tthis.ctx.get_web().update();\r\n\t\tlet onSuccess:Function = Function.createDelegate(this,function(sender:any, err:any){\r\n\t\t\tconsole.log(\"Web properties successfully modified\");\r\n\t\t\tif(this.reloadRequired){\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t} else if(this.refreshTableRequired){\r\n\t\t\t\tthis.refreshAllPropertiesTable();\r\n\t\t\t} else {\r\n\t\t\t\tthis.toggleBlockModal(false);\r\n\t\t\t}\r\n\t\t});\r\n        let onError:Function = Function.createDelegate(this,function(sender:any, err:any){SP.UI.Notify.addNotification(\"Failed to set web property!...<br>\" + err.get_message(), false);});\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n\t};\r\n\tprivate setProperty(key:string, inputId:string) {\r\n\t\tthis.toggleBlockModal(true);\r\n\t\tlet value = (<HTMLInputElement>document.getElementById(inputId)).value;\r\n\t\tthis.allProperties.set_item(key, value);\r\n\t\tthis.executeChanges();\r\n\t};\r\n\tprivate deleteProperty(key:string, inputId:string) {\r\n\t\tif (confirm('Are you sure you want to remove this property? The page will be refreshed after the property has been deleted.')) {\r\n\t\t\tthis.toggleBlockModal(true);\r\n\t\t\tlet table = document.getElementById(inputId).parentNode.parentNode;\r\n\t\t\ttable.parentNode.removeChild(table);\r\n\r\n\t\t\tthis.allProperties.set_item(key);\r\n\t\t\tthis.executeChanges();\r\n\t\t\tthis.reloadRequired = true;\r\n\t\t}\r\n\t};\r\n\tprivate addProperty() {\r\n\t\tthis.toggleBlockModal(true);\r\n\t\tthis.refreshTableRequired = true;\r\n\t\tlet key = (<HTMLInputElement>document.getElementById(\"newKey\")).value;\r\n\t\tlet value = (<HTMLInputElement>document.getElementById(\"newValue\")).value;\r\n\t\t(<HTMLInputElement>document.getElementById(\"newValue\")).value = \"\";\r\n\t\t(<HTMLInputElement>document.getElementById(\"newKey\")).value = \"\";\r\n\t\tthis.allProperties.set_item(key, value);\r\n\t\tthis.executeChanges();\r\n\t};\r\n\tprivate getItemArray(props: any){\r\n\t\tlet p:any;\r\n        let type:string;\r\n        let items:Array<any> = [];\r\n\t\tfor(p in props) {\r\n\t\t\tif (props.hasOwnProperty(p)) {\r\n\t\t\t\ttype = typeof(props[p]);\r\n\t\t\t\tif(type === \"string\") {\r\n\t\t\t\t\titems.push({\"prop\": p, \"value\": props[p].replace(/\"/g, '&quot;')});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\titems.sort(function(a, b) {\r\n\t\t\treturn a.prop.localeCompare(b.prop);\r\n\t\t});\r\n\r\n\t\treturn items;\t\r\n\t};\r\n\tprivate showPropertiesDialog(props: any) {\r\n\r\n\t\tlet items:Array<any> = this.getItemArray(props);\r\n\t\tlet html:HTMLElement = document.createElement('div');\r\n\t\thtml.id = this.divContainerId;\r\n\r\n\t\thtml.innerHTML = this.buildTable(items);\r\n\r\n\t\tSP.UI.ModalDialog.showModalDialog({\r\n\t\t title: \"Property Bag Editor\",\r\n\t\t html:html,\r\n\t\t showClose: true,\r\n\t\t autoSize: true,\r\n\t\t dialogReturnValueCallback: function(dialogResult) {\r\n\t\t\tif(this.reloadRequired){\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t}\r\n\t\t }\r\n\t\t});\r\n\t};\t\r\n}\r\n\r\ndeclare var SpPropAdmin:any;\r\n\r\nSP.SOD.executeFunc('sp.js', 'SP.ClientContext', function(){\r\n    SpPropAdmin = new SpPropertyBag();\r\n});\r\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*\r\n * SpPropertyBag.js\r\n * by rlv-dan (https://github.com/rlv-dan)\r\n * License: GPL3\r\n*/\r\n/// <reference path=\"../typings/sharepoint/SharePoint.d.ts\" />\r\n/// <reference path=\"../typings/microsoft-ajax/microsoft.ajax.d.ts\" />\r\nvar SpPropertyBag = (function () {\r\n    function SpPropertyBag() {\r\n        this.divContainerId = \"divSpPropertyBag\";\r\n        this.divBlockContainerId = \"divBlockSpPropertyBag\";\r\n        this.reloadRequired = false;\r\n        this.refreshTableRequired = false;\r\n        this.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        var onSuccess = Function.createDelegate(this, function (sender, err) { this.showPropertiesDialog(this.allProperties.get_fieldValues()); });\r\n        var onError = Function.createDelegate(this, function (sender, err) { SP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message(), false); });\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    }\r\n    ;\r\n    SpPropertyBag.prototype.toggleBlockModal = function (blockModal) {\r\n        var html = document.getElementById(this.divBlockContainerId);\r\n        html.style.display = blockModal ? 'block' : 'none';\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.refreshAllPropertiesTable = function () {\r\n        this.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        var onSuccess = Function.createDelegate(this, function (sender, err) {\r\n            this.refreshTableRequired = false;\r\n            var props = this.allProperties.get_fieldValues();\r\n            var items = this.getItemArray(props);\r\n            var html = document.getElementById(this.divContainerId);\r\n            html.innerHTML = this.buildTable(items);\r\n            this.toggleBlockModal(false);\r\n        });\r\n        var onError = Function.createDelegate(this, function (sender, err) { SP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message(), false); });\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.buildTable = function (items) {\r\n        var h = '<hr><table style=\"margin: 1em;\">';\r\n        for (var i = 0, itemsCount = items.length; i < itemsCount; i++) {\r\n            h += '<tr>';\r\n            h += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><button onclick=\"SpPropAdmin.setProperty(\\'' + items[i].prop + '\\',\\'prop' + i + '\\'); return false;\">Update</button></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"SpPropAdmin.deleteProperty(\\'' + items[i].prop + '\\',\\'prop' + i + '\\'); return false;\">X</button></td>';\r\n            h += '</tr>';\r\n        }\r\n        h += '</table>';\r\n        h += '<hr><h3>Add a new property:</h3>';\r\n        h += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>';\r\n        h += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>';\r\n        h += '&nbsp;<button onclick=\"SpPropAdmin.addProperty(); return false;\">Add</button></div>';\r\n        h += '<div></div>';\r\n        h += '<div id=\"' + this.divBlockContainerId + '\" style=\"display:none; position: absolute; width: 100%; height: 100%; background-color: gray; top: 0; left: 0;opacity: .8;\"></div>';\r\n        return h;\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.executeChanges = function () {\r\n        this.ctx.get_web().update();\r\n        var onSuccess = Function.createDelegate(this, function (sender, err) {\r\n            console.log(\"Web properties successfully modified\");\r\n            if (this.reloadRequired) {\r\n                window.location.reload();\r\n            }\r\n            else if (this.refreshTableRequired) {\r\n                this.refreshAllPropertiesTable();\r\n            }\r\n            else {\r\n                this.toggleBlockModal(false);\r\n            }\r\n        });\r\n        var onError = Function.createDelegate(this, function (sender, err) { SP.UI.Notify.addNotification(\"Failed to set web property!...<br>\" + err.get_message(), false); });\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.setProperty = function (key, inputId) {\r\n        this.toggleBlockModal(true);\r\n        var value = document.getElementById(inputId).value;\r\n        this.allProperties.set_item(key, value);\r\n        this.executeChanges();\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.deleteProperty = function (key, inputId) {\r\n        if (confirm('Are you sure you want to remove this property? The page will be refreshed after the property has been deleted.')) {\r\n            this.toggleBlockModal(true);\r\n            var table = document.getElementById(inputId).parentNode.parentNode;\r\n            table.parentNode.removeChild(table);\r\n            this.allProperties.set_item(key);\r\n            this.executeChanges();\r\n            this.reloadRequired = true;\r\n        }\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.addProperty = function () {\r\n        this.toggleBlockModal(true);\r\n        this.refreshTableRequired = true;\r\n        var key = document.getElementById(\"newKey\").value;\r\n        var value = document.getElementById(\"newValue\").value;\r\n        document.getElementById(\"newValue\").value = \"\";\r\n        document.getElementById(\"newKey\").value = \"\";\r\n        this.allProperties.set_item(key, value);\r\n        this.executeChanges();\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.getItemArray = function (props) {\r\n        var p;\r\n        var type;\r\n        var items = [];\r\n        for (p in props) {\r\n            if (props.hasOwnProperty(p)) {\r\n                type = typeof (props[p]);\r\n                if (type === \"string\") {\r\n                    items.push({ \"prop\": p, \"value\": props[p].replace(/\"/g, '&quot;') });\r\n                }\r\n            }\r\n        }\r\n        items.sort(function (a, b) {\r\n            return a.prop.localeCompare(b.prop);\r\n        });\r\n        return items;\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.showPropertiesDialog = function (props) {\r\n        var items = this.getItemArray(props);\r\n        var html = document.createElement('div');\r\n        html.id = this.divContainerId;\r\n        html.innerHTML = this.buildTable(items);\r\n        SP.UI.ModalDialog.showModalDialog({\r\n            title: \"Property Bag Editor\",\r\n            html: html,\r\n            showClose: true,\r\n            autoSize: true,\r\n            dialogReturnValueCallback: function (dialogResult) {\r\n                if (this.reloadRequired) {\r\n                    window.location.reload();\r\n                }\r\n            }\r\n        });\r\n    };\r\n    ;\r\n    return SpPropertyBag;\r\n}());\r\nSP.SOD.executeFunc('sp.js', 'SP.ClientContext', function () {\r\n    SpPropAdmin = new SpPropertyBag();\r\n});\r\n},{}]},{},[1])\n\n"],"sourceRoot":"/source/"}