{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/SpPropertyBag.ts","SpPropertyBag.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","SpPropertyBag","this","reloadRequired","ctx","SP","ClientContext","get_current","web","get_web","allProperties","get_allProperties","load","onSuccess","Function","createDelegate","sender","err","showPropertiesDialog","get_fieldValues","onError","UI","Notify","addNotification","get_message","executeQueryAsync","prototype","executeChanges","update","console","log","error","setProperty","key","inputId","value","document","getElementById","set_item","deleteProperty","confirm","table","parentNode","removeChild","addProperty","props","p","type","items","hasOwnProperty","push","prop","replace","sort","b","localeCompare","html","createElement","h","itemsCount","innerHTML","ModalDialog","showModalDialog","title","showClose","autoSize","dialogReturnValueCallback","dialogResult","window","location","reload","SOD","executeFunc","SpPropAdmin"],"mappings":"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","file":"SpPropertyBag.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\r\n * SpPropertyBag.js\r\n * by rlv-dan (https://github.com/rlv-dan)\r\n * License: GPL3\r\n*/\r\n/// <reference path=\"../typings/sharepoint/SharePoint.d.ts\" />\r\n/// <reference path=\"../typings/microsoft-ajax/microsoft.ajax.d.ts\" />\r\n\r\ninterface window {\r\n    SpPropAdmin: any;\r\n}\r\n\r\n\r\nclass SpPropertyBag{\r\n    ctx: SP.ClientContext;\r\n    web:any;\r\n    allProperties:any;\r\n    reloadRequired:boolean;\r\n    constructor(){\r\n        this.reloadRequired = false;\r\n        \r\n        this.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        \r\n        \r\n        let onSuccess:Function = Function.createDelegate(this,function(sender:any, err:any){this. showPropertiesDialog(this.allProperties.get_fieldValues());});\r\n        let onError:Function = Function.createDelegate(this,function(sender:any, err:any){SP.UI.Notify.addNotification(\"DARIOFailed to get web properties...<br>\" + err.get_message(), false);});\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    }\r\n    private executeChanges() {\r\n\t\tthis.ctx.get_web().update();\r\n\t\tthis.ctx.executeQueryAsync(function () {\r\n\t\t\tconsole.log(\"Web properties successfully modified~ \");\r\n\t\t}, function () {\r\n\t\t\tconsole.error(\"Failed to set web property!\");\r\n\t\t});\r\n\t};\r\n\tprivate setProperty(key:string, inputId:string) {\r\n\t\tlet value = (<HTMLInputElement>document.getElementById(inputId)).value;\r\n\t\tthis.allProperties.set_item(key, value);\r\n\t\tthis.executeChanges();\r\n\t};\r\n\tprivate deleteProperty(key:string, inputId:string) {\r\n\t\tif (confirm('Are you sure you want to remove this property?')) {\r\n\t\t\tlet table = document.getElementById(inputId).parentNode.parentNode;\r\n\t\t\ttable.parentNode.removeChild(table);\r\n\r\n\t\t\tthis.allProperties.set_item(key);\r\n\t\t\tthis.executeChanges();\r\n\t\t\tthis.reloadRequired = true;\r\n\t\t}\r\n\t};\r\n\tprivate addProperty() {\r\n\t\tlet key = (<HTMLInputElement>document.getElementById(\"newKey\")).value;\r\n\t\tlet value = (<HTMLInputElement>document.getElementById(\"newValue\")).value;\r\n\t\t(<HTMLInputElement>document.getElementById(\"newValue\")).value = \"\";\r\n\t\t(<HTMLInputElement>document.getElementById(\"newKey\")).value = \"\";\r\n\t\tthis.allProperties.set_item(key, value);\r\n\t\tthis.executeChanges();\r\n\t};\r\n\r\n\tprivate showPropertiesDialog(props: any) {\r\n\t\tlet p:any;\r\n        let type:string;\r\n        let items:Array<any> = [];\r\n\t\tfor(p in props) {\r\n\t\t\tif (props.hasOwnProperty(p)) {\r\n\t\t\t\ttype = typeof(props[p]);\r\n\t\t\t\tif(type === \"string\") {\r\n\t\t\t\t\titems.push({\"prop\": p, \"value\": props[p].replace(/\"/g, '&quot;')});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\titems.sort(function(a, b) {\r\n\t\t\treturn a.prop.localeCompare(b.prop);\r\n\t\t});\r\n\r\n\r\n\t\tlet html:HTMLElement = document.createElement('div');\r\n\t\tlet h:string = '<hr><table style=\"margin: 1em;\">';\r\n\r\n\t\tfor(let i:number=0, itemsCount:number = items.length; i<itemsCount; i++) {\r\n\t\t\th += '<tr>';\r\n\t\t\th += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><button onclick=\"SpPropAdmin.setProperty(\\'' + items[i].prop + '\\',\\'prop' + i +'\\'); return false;\">Update</button></td>';\r\n\t\t\th += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"SpPropAdmin.deleteProperty(\\'' + items[i].prop + '\\',\\'prop' + i +'\\'); return false;\">X</button></td>';\r\n\t\t\th += '</tr>';\r\n\t\t}\r\n\t\th += '</table>';\r\n\r\n\t\th += '<hr><h3>Add a new property:</h3>';\r\n\t\th += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>';\r\n\t\th += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>';\r\n\t\th += '&nbsp;<button onclick=\"SpPropAdmin.addProperty(); return false;\">Add</button></div>';\r\n\t\th += '<div></div>';\r\n\r\n\t\thtml.innerHTML = h;\r\n\r\n\t\tSP.UI.ModalDialog.showModalDialog({\r\n\t\t title: \"Property Bag Editor\",\r\n\t\t html:html,\r\n\t\t showClose: true,\r\n\t\t autoSize: true,\r\n\t\t dialogReturnValueCallback: function(dialogResult) {\r\n\t\t\tif(this.reloadRequired){\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t}\r\n\t\t }\r\n\t\t});\r\n\t}\r\n\r\n\t\r\n}\r\n\r\ndeclare var SpPropAdmin:any;\r\n\r\nSP.SOD.executeFunc('sp.js', 'SP.ClientContext', function(){\r\n    SpPropAdmin = new SpPropertyBag();\r\n});\r\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*\r\n * SpPropertyBag.js\r\n * by rlv-dan (https://github.com/rlv-dan)\r\n * License: GPL3\r\n*/\r\n/// <reference path=\"../typings/sharepoint/SharePoint.d.ts\" />\r\n/// <reference path=\"../typings/microsoft-ajax/microsoft.ajax.d.ts\" />\r\nvar SpPropertyBag = (function () {\r\n    function SpPropertyBag() {\r\n        this.reloadRequired = false;\r\n        this.ctx = SP.ClientContext.get_current();\r\n        this.web = this.ctx.get_web();\r\n        this.allProperties = this.web.get_allProperties();\r\n        this.ctx.load(this.web);\r\n        this.ctx.load(this.allProperties);\r\n        var onSuccess = Function.createDelegate(this, function (sender, err) { this.showPropertiesDialog(this.allProperties.get_fieldValues()); });\r\n        var onError = Function.createDelegate(this, function (sender, err) { SP.UI.Notify.addNotification(\"DARIOFailed to get web properties...<br>\" + err.get_message(), false); });\r\n        this.ctx.executeQueryAsync(onSuccess, onError);\r\n    }\r\n    SpPropertyBag.prototype.executeChanges = function () {\r\n        this.ctx.get_web().update();\r\n        this.ctx.executeQueryAsync(function () {\r\n            console.log(\"Web properties successfully modified~ \");\r\n        }, function () {\r\n            console.error(\"Failed to set web property!\");\r\n        });\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.setProperty = function (key, inputId) {\r\n        var value = document.getElementById(inputId).value;\r\n        this.allProperties.set_item(key, value);\r\n        this.executeChanges();\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.deleteProperty = function (key, inputId) {\r\n        if (confirm('Are you sure you want to remove this property?')) {\r\n            var table = document.getElementById(inputId).parentNode.parentNode;\r\n            table.parentNode.removeChild(table);\r\n            this.allProperties.set_item(key);\r\n            this.executeChanges();\r\n            this.reloadRequired = true;\r\n        }\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.addProperty = function () {\r\n        var key = document.getElementById(\"newKey\").value;\r\n        var value = document.getElementById(\"newValue\").value;\r\n        document.getElementById(\"newValue\").value = \"\";\r\n        document.getElementById(\"newKey\").value = \"\";\r\n        this.allProperties.set_item(key, value);\r\n        this.executeChanges();\r\n    };\r\n    ;\r\n    SpPropertyBag.prototype.showPropertiesDialog = function (props) {\r\n        var p;\r\n        var type;\r\n        var items = [];\r\n        for (p in props) {\r\n            if (props.hasOwnProperty(p)) {\r\n                type = typeof (props[p]);\r\n                if (type === \"string\") {\r\n                    items.push({ \"prop\": p, \"value\": props[p].replace(/\"/g, '&quot;') });\r\n                }\r\n            }\r\n        }\r\n        items.sort(function (a, b) {\r\n            return a.prop.localeCompare(b.prop);\r\n        });\r\n        var html = document.createElement('div');\r\n        var h = '<hr><table style=\"margin: 1em;\">';\r\n        for (var i = 0, itemsCount = items.length; i < itemsCount; i++) {\r\n            h += '<tr>';\r\n            h += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><button onclick=\"SpPropAdmin.setProperty(\\'' + items[i].prop + '\\',\\'prop' + i + '\\'); return false;\">Update</button></td>';\r\n            h += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"SpPropAdmin.deleteProperty(\\'' + items[i].prop + '\\',\\'prop' + i + '\\'); return false;\">X</button></td>';\r\n            h += '</tr>';\r\n        }\r\n        h += '</table>';\r\n        h += '<hr><h3>Add a new property:</h3>';\r\n        h += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>';\r\n        h += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>';\r\n        h += '&nbsp;<button onclick=\"SpPropAdmin.addProperty(); return false;\">Add</button></div>';\r\n        h += '<div></div>';\r\n        html.innerHTML = h;\r\n        SP.UI.ModalDialog.showModalDialog({\r\n            title: \"Property Bag Editor\",\r\n            html: html,\r\n            showClose: true,\r\n            autoSize: true,\r\n            dialogReturnValueCallback: function (dialogResult) {\r\n                if (this.reloadRequired) {\r\n                    window.location.reload();\r\n                }\r\n            }\r\n        });\r\n    };\r\n    return SpPropertyBag;\r\n}());\r\nSP.SOD.executeFunc('sp.js', 'SP.ClientContext', function () {\r\n    SpPropAdmin = new SpPropertyBag();\r\n});\r\n},{}]},{},[1])\n\n"],"sourceRoot":"/source/"}